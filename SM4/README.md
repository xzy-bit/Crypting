### Introduction

This directory contains the codes related with **SM4 Algorithm**.\
sm4.c and sm4.java is the implment of the primitive SM4 algorithm.\
sm4_ecb.c / sm4_cbc.c / sm4_ctr.c / sm4_cfb.c / sm4_ofb.c is the implment of the working-patterns of algorithm based on SM4.

### Details

### sm4.c / sm4.java

The input contains four lines.\
The first line contains a positive integer $T$ , which represents the number of encryption / decryption times. The same key is used.\
The second line is a hexadecimal string $s$ , starting with `0x`and representing the text, guaranteed $|s|=34$;\
The third line is a hexadecimal string $k$ , starting with `0x`, which is the key, guaranteed $|k|=34$;\
The fourth line is a non-negative integer $op$ , representing the encryption / decryption mode, 1 for encryption, and 0 for decryption.\
The Output is a string beginning with `0x` , representing the result of crypting / decrypting.

##### Input 1

```
1
0x1f47f42618704f95e61da82daf959bd8
0x3b3678c215121f0e837e04f58584ed32
1
```

##### Output 1

```
0xf3bf692c7a33557035a115624ef5f976
```

##### Input 2

```
1
0xc04a9b311a2fc245f742c5719fcf249d
0x4046fb1985d94a7f1ff55ec7ec5f6054
0
```

##### Output 2

```
0x6b956ddb0faff373bc338cb600739f23
```

### sm4_ecb.c

The padding according to the standard of PKCS#7.
The input contains several lines.\
The first line is a hexadecimal string $k$ , starting with `0x`, which is the key, guaranteed $|k|=34$;\
The second line is a non-negative integer $op$ , representing the encryption / decryption mode, 1 for encryption, and 0 for decryption.\
Then the next lines contain single byte hexadecimal number , representing the text to be crypted or decrypted , guaranteed the input is legal.
The Output is a string beginning with `0x` , representing the result of crypting / decrypting.

##### Input 1

```
0x9975af70c80ebc0dd06fcef50cf5d49f
1
0xef 0x1a 0x0c
0x11 0xfe 0x30 0x84
0x8a 0x2c 0x02 0xd8 0xc5 0x2c 0x09 0x13 0xc2 0xa1 0x30 0xbf
0x6f 0x35 0x4b 0x37
0x94 0x1b 0x8b 0xd8 0x4a 0xda 0x50 0x3e 0x1f 0xad 0x16 0x28
0xb0 0xbe 0xeb 0x3c
0xfe 0xd1 0x9c 0x54 0x90 0xfd 0x05 0x9e 0x8f 0x98 0x61 0x99
0x90 0x6a 0x94 0x92
0x7c 0x1a 0xed 0x7a 0xe8 0x74 0x93 0x27 0x99 0x08 0xef 0x97
0x22 0x51 0x48 0x9d
0xee 0x46 0x73 0x0a 0xbd 0x4d 0x9c
0x37 0x6f 0x3e 0x4f 0x69
0x42 0xc8 0x34 0x86
0xf3 0x21 0x1f 0x49 0xf8 0x3e 0xca 0x51 0xc9 0x70 0x32 0x31
0x3c 0x1c 0xb7 0x1f
0x1b 0xf9 0x01 0x00 0xca 0x49 0xad 0x5e 0x89 0x48 0xe5 0xab
0x37 0xc0
0xf9 0x72
0x57 0x0c 0x23 0x2e 0x88 0x8f 0xfa 0x30 0x75 0x12 0x25 0x74
0xfa 0x26 0x71 0xaf
0x84 0x13 0xc6 0x36 0x7d 0x6d 0x55 0x44 0x2d 0x0c 0xd2
```

##### Output 1

```
0x68 0xce 0xee 0xb1 0x56 0x96 0x3b 0x49 0x48 0x0b 0x7c 0xfc 0x0e 0xf8 0x96 0x39
0xa1 0x70 0x52 0xe2 0xdb 0xd4 0xa9 0x73 0x18 0x3f 0x68 0xbc 0xb3 0x6a 0xd7 0x02
0xc5 0x8f 0xf0 0x7c 0xce 0x82 0xa4 0xe8 0x09 0xbc 0x3b 0x46 0x40 0x5c 0x53 0xa6
0x9c 0xd6 0x1b 0xaf 0x4c 0xe3 0xa4 0x76 0xde 0x62 0x8a 0x55 0x5f 0x8e 0x48 0xc4
0xf5 0x1a 0x05 0xce 0xfe 0x4c 0xab 0xc7 0x00 0xf7 0x95 0x52 0x15 0x28 0x7c 0x0b
0xde 0x81 0xef 0x9c 0xac 0x11 0x8f 0x89 0x59 0xbd 0xa7 0xbc 0x46 0x0e 0x9a 0xe3
0x2c 0x34 0x55 0x50 0x27 0xf9 0xa6 0x42 0x52 0xa5 0xc5 0x58 0x1b 0x74 0xb9 0x37
0x5b 0xff 0xf2 0xca 0x7f 0xd7 0xfc 0xa4 0xca 0xa6 0x27 0x11 0x86 0xd8 0xd1 0xbc
0xf0 0x30 0xdb 0x61 0xd0 0x56 0x49 0x07 0x3d 0x13 0x8f 0x4f 0xd4 0xa4 0x71 0x5c
0xf7 0x3f 0x14 0x2b 0x5a 0x25 0xa4 0x70 0x00 0xf6 0xe9 0xfd 0x50 0x7f 0x10 0x22

```

##### Input 2

```
0x4ce0a125d5642eb5a56bcb4e7b850a49
0
0xf6 0x54 0xc7 0xdc 0x04
0xe9
0x17 0x48 0x1d 0xb1 0x73 0x12 0xd1 0x77 0x04 0x6d 0xba 0x25 0x39 0x60 0x4e
0xb6
0x0a 0x09 0x5e 0x4d 0xfd
0x65 0x67 0x65 0x47 0x79 0xff 0xd4 0xa7 0x38 0x3f
0x38
0x4b 0x03 0x03 0x62 0xa9 0xe8 0x03 0x2e 0xbf 0x51 0x01 0xf5 0xcd 0xda 0x34
0x99
0x31 0x54 0x0a 0xe3 0xc7 0x2b 0x6e 0x2e 0x05 0x27 0xe2 0xdf
0x76 0x46 0xee
0x93
0x37 0xa0 0x66 0x4a 0xad 0xb6 0xea 0xa1 0xc3 0x8e 0xc0 0xae 0xf2 0x27 0xff
0xb1
0xe2 0x00 0x27 0x09 0xf2 0xce 0xb9 0xc2 0xe9 0x82 0x0a 0xdf 0x36 0x90 0x42
0x24
0xcf 0x59 0xb8
0x61 0xa4 0xaa 0x8e 0x3f 0x3a 0x7d 0x5f 0x35 0x84 0xd7 0x54
0xbb
0x4e 0xdb 0x44 0xd2 0x9e 0xd9 0x7a 0xda 0x4b 0xec 0x2c 0x93 0xa6 0xa9 0x9e
0x49
0x4e 0x92 0x00 0x2f 0x52 0x2f 0xc5 0xc7 0x54 0x6b
0xe7 0xf4 0x09 0x2c 0xc7
0x5f
0x84 0xff 0xb5 0x5a 0xcb 0x6e 0x64 0x16 0xce 0x9e
```

##### Output 2

```
0x4c 0xe0 0xa1 0x25 0xd5 0x64 0x2e 0xb5 0xa5 0x6b 0xcb 0x4e 0x7b 0x85 0x0a 0x49
0x43 0xe8 0xa2 0x23 0xd4 0x19 0xe5 0x4d 0x5b 0xe6 0xa5 0x19 0x98 0xa6 0x84 0x67
0xd3 0x4b 0xa1 0xb0 0xa7 0x89 0xa4 0x69 0x1c 0xf8 0x99 0xde 0x2e 0x7c 0x2d 0x75
0xa6 0xf6 0x61 0x99 0xe2 0xb1 0xca 0x50 0x15 0x49 0x88 0x1f 0x92 0xc4 0x35 0xb6
0xae 0x29 0xf0 0x71 0x13 0xed 0x9f 0x08 0x13 0xf2 0x3f 0x64 0x5f 0xa1 0x38 0xbe
0x24 0xb8 0x06 0xaa 0x20 0x6e 0x89 0xd0 0x55 0xf1 0x30 0x84 0xb9 0xfb 0xd9 0x65
0x17 0x06 0xac 0x40 0xd8 0xf4 0x03 0x49 0x26 0xdc 0xdd 0x2b 0x0f 0xd2 0x19 0x2d
0xcf 0x2d 0xe7 0x87 0xcf 0xd6 0x14 0x49 0x89 0xf9 0x79 0x4f 0xb9 0xbb 0x8d 0xd9
0x1c 0x50 0x0c 0x33 0xc2 0xc5 0x5b 0xdb 0xd3 0xc5 0x1c 0x77 0xbb 0x19 0x12 0x8f
0xb6 0x60 0x24 
```

### sm4_cbc.c

The padding according to the standard of PKCS#7.
The input contains several lines.\
The first line is a hexadecimal string $k$ , starting with `0x`, which is the key, guaranteed $|k|=34$;\
The second line is a hexadecimal string $IV$ , starting with `0x`, which is the innitialization vector , guaranteed $|IV|=34$;\
The second line is a non-negative integer $op$ , representing the encryption / decryption mode, 1 for encryption, and 0 for decryption.\
Then the next lines contain single byte hexadecimal number , representing the text to be crypted or decrypted , guaranteed the input is legal.
The Output is a string beginning with `0x` , representing the result of crypting / decrypting.

##### Input 1

```
0x7dfee2f716c4c4cd5217f0d57c75c2d7
0xa8638d2fb23cc49206edd7c84532eaab
1
0xa8 0x05
0x28 0xbe 0xe1 0x68 0x85 0x7b 0xb6 0xd2 0xd5 0xef 0xaf 0x9d 0xb7
0x59 0xd2 0x50
0x0b 0xce 0x1a 0xb2 0x18 0x39 0x1b
0xdb 0x0b 0x83 0x9d 0x5b 0x28
0x64 0xe9 0x53
0x18 0x42 0xfd 0x0c 0x38 0x68 0x20 0xb4 0xd7 0xde 0xf9 0xc1 0x68
0x68 0x84 0x8e
0xa1 0x1b 0xab 0x92 0x46 0x5c 0xde 0x82 0xed 0x19 0x44 0x94 0x7d
0x32
0x73 0x3c
0x00 0xb4 0x91 0x97 0x33 0xd2 0x94 0x0b 0x9d 0x6f 0x0f 0xb7 0xbb
0x05 0x82 0x4a
0x38 0x3d 0x9c 0xe7 0x72 0x11 0xe3 0xee 0x83 0x8f 0xb5 0x5a 0x60
0xc1 0xbf 0x16
0x2b 0x15 0x1b 0xd6 0xea
0x20 0x2b 0x18 0xe0 0x69 0x89 0xb2 0x93
0xa3 0x13 0x19
0xd9 0x0e 0xad 0x52 0xfd 0xc5 0x4e 0x92 0x0b 0x04 0xb3 0xcf 0x50
0xed 0x01 0xb6
0x57 0xd6 0x6d 0x43 0x87 0x42 0x89 0xac 0x4c 0xca 0x65 0xcc
0xd7
0xd2 0x71 0x94
```

##### Output 1

```
0xff 0xa3 0x0c 0xe7 0x5f 0xb7 0x68 0x93 0xd4 0xec 0x43 0x6a 0xfe 0xbb 0xd4 0x24
0xc8 0xd5 0xc7 0x56 0x88 0x71 0x2c 0x17 0x77 0xae 0x14 0x40 0x52 0xec 0x08 0x73
0xb9 0xdb 0x64 0xf8 0x5a 0xc4 0x45 0xe5 0x4e 0x50 0x8f 0x0c 0xf0 0x07 0xdd 0x5d
0xd2 0xce 0xfd 0x5a 0xb0 0x3d 0x05 0xe8 0x70 0x78 0xdc 0x49 0xec 0x59 0x91 0x5a
0xd2 0xe6 0xe0 0x84 0xe1 0x21 0x76 0x7f 0x21 0x8a 0x30 0xad 0xfb 0x11 0x0d 0x27
0xf1 0x86 0x17 0x1a 0x14 0x83 0x2a 0x30 0x77 0x5a 0x3f 0xb8 0x0a 0x73 0x6c 0xed
0x79 0xdc 0xc6 0xa8 0x1d 0xb2 0xfb 0xef 0x5a 0xbf 0x4f 0x36 0x05 0x32 0xd7 0xae
0x02 0xcf 0xaf 0xc6 0x45 0xac 0xb2 0xc9 0x43 0x7d 0x12 0x45 0x5a 0xe8 0xba 0xbf
0x53 0xef 0x66 0xa9 0x76 0x6c 0x6a 0xf7 0xa5 0xf4 0x56 0xe3 0x6d 0x4a 0x83 0x0b
0x64 0x09 0xcc 0x89 0x71 0x8c 0xf0 0x10 0xed 0x65 0x66 0xe5 0x79 0xa4 0x9e 0xed

```

##### Input 2

```
0x5d697028c34392edb83cbed6978ba30c
0x87656916ca54c58ae6885c1a79997aa2
0
0x1b 0xf6 0x2d 0xe1 0xf4
0x20
0xf0 0x06 0xa4 0x31 0x77 0xd0 0xf3 0x82 0x80 0xb0 0xfb 0xf1 0xd6 0xb6 0xf4
0x2c
0xf8 0x00 0xb1 0x8d 0x2c
0xfe 0x3a 0xc2 0x41 0x6a 0x4a 0xda 0x00 0xe8 0xb4
0x65
0x43 0xe6 0x92 0x73 0x4f 0x01 0x21 0x87 0xfb 0xd4 0x00 0xc4 0x89 0x46 0xef
0x97
0x2c 0x73 0xfd 0xf3 0x65 0xad 0x24 0x79 0xd4 0xac 0xd6 0x23
0xa7 0x8b 0xf9
0xfd
0xa7 0x70 0xc4 0x1c 0xf6 0xc7 0x03 0x41 0xd4 0xaa 0xeb 0x34 0xd2 0xd1 0xf9
0xc7
0x10 0x06 0x4b 0x2e 0x91 0xff 0x11 0x5d 0xd9 0xc0 0x9e 0x73 0xd8 0x9d 0x13
0xc6
0x74 0x25 0x4b
0x8a 0xda 0xcf 0x2f 0x3d 0x5d 0xd6 0x39 0x93 0x04 0x54 0x5c
0xe9
0xb9 0x2f 0xf9 0xf8 0x54 0x71 0x77 0x1c 0xb3 0xb6 0x56 0x02 0x97 0x49 0xbe
0x02
0x7a 0xc7 0xbb 0x8d 0xe9 0x2b 0xa9 0x7a 0x3b 0xa2
0x38 0x53 0xaa 0xb0 0xc3
0x6c
0xfe 0x6f 0x88 0xd6 0x26 0xd4 0xe5 0x81 0x5c 0xdf
```

##### Output 2

```
0x2a 0x3f 0x54 0x40 0x48 0x1e 0x21 0x9d 0xac 0x9b 0x27 0xef 0x69 0xa9 0xff 0x72
0x44 0x1f 0x1b 0x4d 0x06 0x04 0x97 0x23 0x03 0x6c 0x33 0x95 0x6d 0x47 0xf2 0x93
0x41 0x5f 0x7c 0xf7 0x44 0x4d 0x71 0xeb 0x14 0x56 0x6c 0xc4 0x7c 0xa7 0x77 0x3f
0x64 0x5a 0x06 0x8d 0x1b 0xdc 0xa2 0x5a 0x40 0x45 0x4b 0x4e 0xc8 0x20 0xa6 0xb0
0x36 0xb7 0xa1 0xf4 0x09 0x7d 0x8d 0xcf 0xbe 0xa1 0x95 0x9b 0xfe 0xe4 0x6e 0x3e
0x51 0xf2 0x34 0xa3 0x98 0xca 0x06 0xa7 0x3d 0x3d 0xea 0x13 0x82 0x96 0x54 0x3e
0x6d 0xc8 0x00 0xb1 0x39 0x46 0xfc 0xf0 0x0c 0x9e 0x9c 0x5b 0x3b 0xc3 0x77 0x6e
0xce 0xb6 0x9f 0xd0 0x5e 0x34 0xde 0x13 0x3e 0x9f 0x3d 0x1f 0x59 0xdf 0xc7 0x10
0xfe 0xff 0x02 0xed 0x3f 0xe7 0x96 0x64 0xd6 0x96 0xd6 0xec 0x54 0xd4 0xae 0xe0
0xe0 0x2e 0x77
```




